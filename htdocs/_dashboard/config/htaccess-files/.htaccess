# ------------------------------------------
# Universal .htaccess for PHP projects
# ------------------------------------------
<IfModule mod_rewrite.c>
  RewriteEngine On

  # --- Normalize domain (optional) ---
  #RewriteCond %{HTTP_HOST} ^www\.(.*)$ [NC]
  #RewriteRule ^ https://%1%{REQUEST_URI} [R=301,L]

  # --- Deny direct access to sensitive files ---
  <FilesMatch "\.(env|ini|log|sql|bak|git|md|yaml|yml|json|lock)$">
    Require all denied
  </FilesMatch>

  # --- Rewrite all non-existing files/folders to index.php ---
  RewriteCond %{REQUEST_FILENAME} !-f
  RewriteCond %{REQUEST_FILENAME} !-d
  RewriteRule ^ index.php [QSA,L]
</IfModule>

# --- Disable directory listing ---
Options -Indexes

# --- Prevent MultiViews from breaking routes ---
Options -MultiViews

# --- Set default charset ---
AddDefaultCharset UTF-8

# --- Cache static assets (optional tweak) ---
<IfModule mod_expires.c>
  ExpiresActive On
  ExpiresByType image/jpg "access plus 1 year"
  ExpiresByType image/jpeg "access plus 1 year"
  ExpiresByType image/png "access plus 1 year"
  ExpiresByType image/gif "access plus 1 year"
  ExpiresByType image/webp "access plus 1 year"
  ExpiresByType text/css "access plus 1 month"
  ExpiresByType application/javascript "access plus 1 month"
  ExpiresByType application/x-javascript "access plus 1 month"
  ExpiresDefault "access plus 3 days"
</IfModule>

# --- Basic security headers (optional, safe defaults) ---
<IfModule mod_headers.c>
  Header always set X-Frame-Options "SAMEORIGIN"
  Header always set X-Content-Type-Options "nosniff"
  Header always set Referrer-Policy "strict-origin-when-cross-origin"
  Header always set X-XSS-Protection "1; mode=block"
</IfModule>
